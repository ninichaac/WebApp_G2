<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/public/css/bootstrap.min.css">
  <script src="/public/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="/public/css/Student/search.css">
  <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <title>Room List</title>
</head>

<body>
  <nav>
    <div class="logo-name">
      <div class="logo-image">
        <img src="/public/img/student.png" alt="">
      </div>
    </div>
    <div class="logo-name1">
      <h3 class="logo_name1">Student 1</h3>
      <p class="logo_name1">Student</p>
    </div>

    <div class="menu-items">
      <ul class="nav-links">
          <li>
              <a href="/Student/homepage">
                  <i class="uil uil-estate"></i>
                  <span class="link-name">Home Page</span>
              </a>
          </li>
          <li>
              <a href="/Student/rooms/:id">
                  <i class="uil uil-search"></i>
                  <span class="link-name">Room List</span>
              </a>
          </li>

          <li>
              <a href="/Student/status">
                  <i class="uil uil-notes"></i>
                  <span class="link-name">Booking Status</span>
              </a>
          </li>
      </ul>

      <ul class="logout-mode">
          <li>
              <a href="/logout">
                  <i class="uil uil-signout" style="color: red;"></i>
                  <span class="link-name1">Log out</span>
              </a>
          </li>
      </ul>
  </div>
  </nav>

  <section class="dashboard">
    <div class="top">
      <i class="uil uil-bars sidebar-toggle"></i>
      <h1 class="dash">Room List</h1>
      <date-picker class="date-picker" format="MMMM DD (DDD), YYYY"></date-picker>
      <div class="search-box">
        <i class="uil uil-search"></i>
        <input type="text" placeholder="Search here...">
      </div>
    </div>

    <div class="dash-content">
      <div class="row1" id="row">
        <div class="container">
          <div class="meeting">
            <div class="img">
              <img src="/public/img/room1.webp">
            </div>
            <div class="info">
              <h6 class="mt-2"><b>Meeting Room 1</b></h6>
              <i class="uil uil-map-marker"></i>
              <span> C1 101</span> <br>
              <i class="uil uil-user"></i>
              <span>6-8 persons</span>
            </div>
          </div>
          <table class="table table-bordered text-center mt-2">

            <tr>
              <td>8-10 A.M.</td>
              <td> <span class="dot bg-success" style="height: 12px;
                                width: 12px;  
                                border-radius: 50%;
                                display: inline-block;"></span>
                Available
              </td>
              <td>
                <button class="btn btn-success btn-sm col-9" onclick="booking()">Booking</button>
              </td>

            </tr>
            <tr>
              <td>10-12 P.M.</td>
              <td>
                <span class="dot bg-warning" style="height: 12px;
                          width: 12px;
                          border-radius: 50%;
                          display: inline-block;"></span>
                Reserved
              </td>
              <td>
                <button class="btn btn-primary btn-sm btn-warning col-9">Reserved</button>
              </td>
            </tr>
            <tr>
              <td>12-15 P.M.</td>
              <td> <span class="dot bg-success" style="height: 12px;
                          width: 12px;
                          
                          border-radius: 50%;
                          display: inline-block;"></span>
                Available</td>
              <td>
                <button class="btn btn-primary btn-sm btn-success col-9">Booking</button>
              </td>
            </tr>
            <tr>
              <td>15-17 P.M.</td>
              <td> <span class="dot bg-info" style="height: 12px;
                          width: 12px;
                        
                          border-radius: 50%;
                          display: inline-block;"></span>
                Waiting</td>
              <td>
                <button class="btn btn-primary btn-sm btn-info col-9">Waiting</button>
              </td>
            </tr>
          </table>
        </div>

        <div class="container">
          <div class="meeting">
            <div class="img">
              <img src="/public/img/meeting5.webp">
            </div>
            <div class="info">
              <h6 class="mt-2"><b>Meeting Room 2</b></h6>
              <i class="uil uil-map-marker"></i>
              <span> C1 101</span> <br>
              <i class="uil uil-user"></i>
              <span>6-8 persons</span>
            </div>
          </div>
          <table class="table table-bordered text-center mt-2">
            <tr>
              <td>8-10 A.M.</td>
              <td> <span class="dot bg-success" style="height: 12px;
                                width: 12px;  
                                border-radius: 50%;
                                display: inline-block;"></span>
                Available
              </td>
              <td>
                <button class="btn btn-primary btn-sm btn-success col-9">Booking</button>
              </td>

            </tr>
            <tr>
              <td>10-12 P.M.</td>
              <td>
                <span class="dot bg-warning" style="height: 12px;
                          width: 12px;
                          border-radius: 50%;
                          display: inline-block;"></span>
                Reserved
              </td>
              <td>
                <button class="btn btn-primary btn-sm btn-warning col-9">Reserved</button>
              </td>
            </tr>
            <tr>
              <td>12-15 P.M.</td>
              <td> <span class="dot bg-success" style="height: 12px;
                          width: 12px;
                          
                          border-radius: 50%;
                          display: inline-block;"></span>
                Available</td>
              <td>
                <button class="btn btn-primary btn-sm btn-success col-9">Booking</button>
              </td>
            </tr>
            <tr>
              <td>15-17 P.M.</td>
              <td> <span class="dot bg-info" style="height: 12px;
                          width: 12px;
                        
                          border-radius: 50%;
                          display: inline-block;"></span>
                Waiting</td>
              <td>
                <button class="btn btn-primary btn-sm btn-info col-9">Waiting</button>
              </td>
            </tr>
          </table>
        </div>

        <div class="container">
          <div class="meeting">
            <div class="img">
              <img src="/public/img/meeting2.jpg">
            </div>
            <div class="info">
              <h6 class="mt-2"><b>Meeting Room 3</b></h6>
              <i class="uil uil-map-marker"></i>
              <span> C1 101</span> <br>
              <i class="uil uil-user"></i>
              <span>6-8 persons</span>
            </div>
          </div>
          <table class="table table-bordered text-center mt-2">
            <tr>
              <td>8-10 A.M.</td>
              <td> <span class="dot bg-success" style="height: 12px;
                                width: 12px;  
                                border-radius: 50%;
                                display: inline-block;"></span>
                Available
              </td>
              <td>
                <button class="btn btn-primary btn-sm btn-success col-9">Booking</button>
              </td>

            </tr>
            <tr>
              <td>10-12 P.M.</td>
              <td>
                <span class="dot bg-warning" style="height: 12px;
                          width: 12px;
                          border-radius: 50%;
                          display: inline-block;"></span>
                Reserved
              </td>
              <td>
                <button class="btn btn-primary btn-sm btn-warning col-9">Reserved</button>
              </td>
            </tr>
            <tr>
              <td>12-15 P.M.</td>
              <td> <span class="dot bg-success" style="height: 12px;
                          width: 12px;
                          
                          border-radius: 50%;
                          display: inline-block;"></span>
                Available</td>
              <td>
                <button class="btn btn-primary btn-sm btn-success col-9">Booking</button>
              </td>
            </tr>
            <tr>
              <td>15-17 P.M.</td>
              <td> <span class="dot bg-info" style="height: 12px;
                          width: 12px;
                        
                          border-radius: 50%;
                          display: inline-block;"></span>
                Waiting</td>
              <td>
                <button class="btn btn-primary btn-sm btn-info col-9">Waiting</button>
              </td>
            </tr>
          </table>
        </div>
      </div>

      <div class="row1">
        <div class="container">
          <div class="meeting">
            <div class="img">
              <img src="/public/img/meeting3.jpg">
            </div>
            <div class="info">
              <h6 class="mt-2"><b>Meeting Room 4</b></h6>
              <i class="uil uil-map-marker"></i>
              <span> C1 101</span> <br>
              <i class="uil uil-user"></i>
              <span>6-8 persons</span>
            </div>
          </div>
          <table class="table table-bordered text-center mt-2">
            <tr>
              <td>8-10 A.M.</td>
              <td> <span class="dot bg-success" style="height: 12px;
                                width: 12px;  
                                border-radius: 50%;
                                display: inline-block;"></span>
                Available
              </td>
              <td>
                <button class="btn btn-primary btn-sm btn-success col-9">Booking</button>
              </td>

            </tr>
            <tr>
              <td>10-12 P.M.</td>
              <td>
                <span class="dot bg-warning" style="height: 12px;
                          width: 12px;
                          border-radius: 50%;
                          display: inline-block;"></span>
                Reserved
              </td>
              <td>
                <button class="btn btn-primary btn-sm btn-warning col-9">Reserved</button>
              </td>
            </tr>
            <tr>
              <td>12-15 P.M.</td>
              <td> <span class="dot bg-success" style="height: 12px;
                          width: 12px;
                          
                          border-radius: 50%;
                          display: inline-block;"></span>
                Available</td>
              <td>
                <button class="btn btn-primary btn-sm btn-success col-9">Booking</button>
              </td>
            </tr>
            <tr>
              <td>15-17 P.M.</td>
              <td> <span class="dot bg-info" style="height: 12px;
                          width: 12px;
                        
                          border-radius: 50%;
                          display: inline-block;"></span>
                Waiting</td>
              <td>
                <button class="btn btn-primary btn-sm btn-info col-9">Waiting</button>
              </td>
            </tr>
          </table>
        </div>

        <div class="container">
          <div class="meeting">
            <div class="img">
              <img src="/public/img/meeting3.jpg">
            </div>
            <div class="info">
              <h6 class="mt-2"><b>Meeting Room 5</b></h6>
              <i class="uil uil-map-marker"></i>
              <span> C1 101</span> <br>
              <i class="uil uil-user"></i>
              <span>6-8 persons</span>
            </div>
          </div>
          <table class="table table-bordered text-center mt-2">
            <tr>
              <td>8-10 A.M.</td>
              <td> <span class="dot bg-success" style="height: 12px;
                                width: 12px;  
                                border-radius: 50%;
                                display: inline-block;"></span>
                Available
              </td>
              <td>
                <button class="btn btn-primary btn-sm btn-success col-9">Booking</button>
              </td>

            </tr>
            <tr>
              <td>10-12 P.M.</td>
              <td>
                <span class="dot bg-warning" style="height: 12px;
                          width: 12px;
                          border-radius: 50%;
                          display: inline-block;"></span>
                Reserved
              </td>
              <td>
                <button class="btn btn-primary btn-sm btn-warning col-9">Reserved</button>
              </td>
            </tr>
            <tr>
              <td>12-15 P.M.</td>
              <td> <span class="dot bg-success" style="height: 12px;
                          width: 12px;
                          
                          border-radius: 50%;
                          display: inline-block;"></span>
                Available</td>
              <td>
                <button class="btn btn-primary btn-sm btn-success col-9">Booking</button>
              </td>
            </tr>
            <tr>
              <td>15-17 P.M.</td>
              <td> <span class="dot bg-info" style="height: 12px;
                          width: 12px;
                        
                          border-radius: 50%;
                          display: inline-block;"></span>
                Waiting</td>
              <td>
                <button class="btn btn-primary btn-sm btn-info col-9">Waiting</button>
              </td>
            </tr>
          </table>
        </div>

        <div class="container">
          <div class="meeting">
            <div class="img">
              <img src="/public/img/meeting5.webp">
            </div>
            <div class="info">
              <h6 class="mt-2"><b>Meeting Room 6</b></h6>
              <i class="uil uil-map-marker"></i>
              <span> C1 101</span> <br>
              <i class="uil uil-user"></i>
              <span>6-8 persons</span>
            </div>
          </div>
          <table class="table table-bordered text-center mt-2">
            <tr>
              <td>8-10 A.M.</td>
              <td> <span class="dot bg-success" style="height: 12px;
                                width: 12px;  
                                border-radius: 50%;
                                display: inline-block;"></span>
                Available
              </td>
              <td>
                <button class="btn btn-primary btn-sm btn-success col-9">Booking</button>
              </td>

            </tr>
            <tr>
              <td>10-12 P.M.</td>
              <td>
                <span class="dot bg-warning" style="height: 12px;
                          width: 12px;
                          border-radius: 50%;
                          display: inline-block;"></span>
                Reserved
              </td>
              <td>
                <button class="btn btn-primary btn-sm btn-warning col-9">Reserved</button>
              </td>
            </tr>
            <tr>
              <td>12-15 P.M.</td>
              <td> <span class="dot bg-success" style="height: 12px;
                          width: 12px;
                          
                          border-radius: 50%;
                          display: inline-block;"></span>
                Available</td>
              <td>
                <button class="btn btn-primary btn-sm btn-success col-9">Booking</button>
              </td>
            </tr>
            <tr>
              <td>15-17 P.M.</td>
              <td> <span class="dot bg-info" style="height: 12px;
                          width: 12px;
                        
                          border-radius: 50%;
                          display: inline-block;"></span>
                Waiting</td>
              <td>
                <button class="btn btn-primary btn-sm btn-info col-9">Waiting</button>
              </td>
            </tr>
          </table>
        </div>
      </div>

      <div class="row1">
        <div class="container">
          <div class="meeting">
            <div class="img">
              <img src="/public/img/room1.webp">
            </div>
            <div class="info">
              <h6 class="mt-2"><b>Meeting Room 7</b></h6>
              <i class="uil uil-map-marker"></i>
              <span> C1 101</span> <br>
              <i class="uil uil-user"></i>
              <span>6-8 persons</span>
            </div>
          </div>
          <table class="table table-bordered text-center mt-2">
            <tr>
              <td>8-10 A.M.</td>
              <td> <span class="dot bg-success" style="height: 12px;
                                width: 12px;  
                                border-radius: 50%;
                                display: inline-block;"></span>
                Available
              </td>
              <td>
                <button class="btn btn-primary btn-sm btn-success col-9">Booking</button>
              </td>

            </tr>
            <tr>
              <td>10-12 P.M.</td>
              <td>
                <span class="dot bg-warning" style="height: 12px;
                          width: 12px;
                          border-radius: 50%;
                          display: inline-block;"></span>
                Reserved
              </td>
              <td>
                <button class="btn btn-primary btn-sm btn-warning col-9">Reserved</button>
              </td>
            </tr>
            <tr>
              <td>12-15 P.M.</td>
              <td> <span class="dot bg-success" style="height: 12px;
                          width: 12px;
                          
                          border-radius: 50%;
                          display: inline-block;"></span>
                Available</td>
              <td>
                <button class="btn btn-primary btn-sm btn-success col-9">Booking</button>
              </td>
            </tr>
            <tr>
              <td>15-17 P.M.</td>
              <td> <span class="dot bg-info" style="height: 12px;
                          width: 12px;
                        
                          border-radius: 50%;
                          display: inline-block;"></span>
                Waiting</td>
              <td>
                <button class="btn btn-primary btn-sm btn-info col-9">Waiting</button>
              </td>
            </tr>
          </table>
        </div>

        <div class="container">
          <div class="meeting">
            <div class="img">
              <img src="/public/img/room1.webp">
            </div>
            <div class="info">
              <h6 class="mt-2"><b>Meeting Room 8</b></h6>
              <i class="uil uil-map-marker"></i>
              <span> C1 101</span> <br>
              <i class="uil uil-user"></i>
              <span>6-8 persons</span>
            </div>
          </div>
          <table class="table table-bordered text-center mt-2">
            <tr>
              <td>8-10 A.M.</td>
              <td> <span class="dot bg-success" style="height: 12px;
                                width: 12px;  
                                border-radius: 50%;
                                display: inline-block;"></span>
                Available
              </td>
              <td>
                <button class="btn btn-primary btn-sm btn-success col-9">Booking</button>
              </td>

            </tr>
            <tr>
              <td>10-12 P.M.</td>
              <td>
                <span class="dot bg-warning" style="height: 12px;
                          width: 12px;
                          border-radius: 50%;
                          display: inline-block;"></span>
                Reserved
              </td>
              <td>
                <button class="btn btn-primary btn-sm btn-warning col-9">Reserved</button>
              </td>
            </tr>
            <tr>
              <td>12-15 P.M.</td>
              <td> <span class="dot bg-success" style="height: 12px;
                          width: 12px;
                          
                          border-radius: 50%;
                          display: inline-block;"></span>
                Available</td>
              <td>
                <button class="btn btn-primary btn-sm btn-success col-9">Booking</button>
              </td>
            </tr>
            <tr>
              <td>15-17 P.M.</td>
              <td> <span class="dot bg-info" style="height: 12px;
                          width: 12px;
                        
                          border-radius: 50%;
                          display: inline-block;"></span>
                Waiting</td>
              <td>
                <button class="btn btn-primary btn-sm btn-info col-9">Waiting</button>
              </td>
            </tr>
          </table>
        </div>

        <div class="container">
          <div class="meeting">
            <div class="img">
              <img src="/public/img/room1.webp">
            </div>
            <div class="info">
              <h6 class="mt-2"><b>Meeting Room 9</b></h6>
              <i class="uil uil-map-marker"></i>
              <span> C1 101</span> <br>
              <i class="uil uil-user"></i>
              <span>6-8 persons</span>
            </div>
          </div>
          <table class="table table-bordered text-center mt-2">
            <tr>
              <td>8-10 A.M.</td>
              <td> <span class="dot bg-success" style="height: 12px;
                                width: 12px;  
                                border-radius: 50%;
                                display: inline-block;"></span>
                Available
              </td>
              <td>
                <button class="btn btn-primary btn-sm btn-success col-9">Booking</button>
              </td>

            </tr>
            <tr>
              <td>10-12 P.M.</td>
              <td>
                <span class="dot bg-warning" style="height: 12px;
                          width: 12px;
                          border-radius: 50%;
                          display: inline-block;"></span>
                Reserved
              </td>
              <td>
                <button class="btn btn-primary btn-sm btn-warning col-9">Reserved</button>
              </td>
            </tr>
            <tr>
              <td>12-15 P.M.</td>
              <td> <span class="dot bg-success" style="height: 12px;
                          width: 12px;   
                          border-radius: 50%;
                          display: inline-block;"></span>
                Available</td>
              <td>
                <button class="btn btn-primary btn-sm btn-success col-9">Booking</button>
              </td>
            </tr>
            <tr>
              <td>15-17 P.M.</td>
              <td> <span class="dot bg-info" style="height: 12px;
                          width: 12px;
                          border-radius: 50%;
                          display: inline-block;"></span>
                Waiting</td>
              <td>
                <button class="btn btn-primary btn-sm btn-info col-9">Waiting</button>
              </td>
            </tr>
          </table>
        </div>
      </div>
    </div>
  </section>

  <script>

    function booking() {
      window.location.replace("/Student/booking");
    }

    const body = document.querySelector("body"),
      sidebar = body.querySelector("nav");
    sidebarToggle = body.querySelector(".sidebar-toggle");

    let getStatus = localStorage.getItem("status");
    if (getStatus && getStatus === "close") {
      sidebar.classList.toggle("close");
    }

    sidebarToggle.addEventListener("click", () => {
      sidebar.classList.toggle("close");
      if (sidebar.classList.contains("close")) {
        localStorage.setItem("status", "close");
      } else {
        localStorage.setItem("status", "open");
      }
    })

    function getWeekNumber(date) {
      const firstDayOfTheYear = new Date(date.getFullYear(), 0, 1);
      const pastDaysOfYear = (date.getTime() - firstDayOfTheYear.getTime()) / 86400000;

      return Math.ceil((pastDaysOfYear + firstDayOfTheYear.getDay() + 1) / 7)
    }

    function isLeapYear(year) {
      return year % 100 === 0 ? year % 400 === 0 : year % 4 === 0;
    }

    class Day {
      constructor(date = null, lang = 'default') {
        date = date ?? new Date();

        this.Date = date;
        this.date = date.getDate();
        this.day = date.toLocaleString("en-us", { weekday: 'long' });
        this.dayNumber = date.getDay() + 1;
        this.dayShort = date.toLocaleString("en-us", { weekday: 'short' });
        this.year = date.getFullYear();
        this.yearShort = date.toLocaleString("en-us", { year: '2-digit' });
        this.month = date.toLocaleString("en-us", { month: 'long' });
        this.monthShort = date.toLocaleString("en-us", { month: 'short' });
        this.monthNumber = date.getMonth() + 1;
        this.timestamp = date.getTime();
        this.week = getWeekNumber(date);
      }

      get isToday() {
        return this.isEqualTo(new Date());
      }

      isEqualTo(date) {
        date = date instanceof Day ? date.Date : date;

        return date.getDate() === this.date &&
          date.getMonth() === this.monthNumber - 1 &&
          date.getFullYear() === this.year;
      }

      format(formatStr) {
        return formatStr
          .replace(/\bYYYY\b/, this.year)
          .replace(/\bYYY\b/, this.yearShort)
          .replace(/\bWW\b/, this.week.toString().padStart(2, '0'))
          .replace(/\bW\b/, this.week)
          .replace(/\bDDDD\b/, this.day)
          .replace(/\bDDD\b/, this.dayShort)
          .replace(/\bDD\b/, this.date.toString().padStart(2, '0'))
          .replace(/\bD\b/, this.date)
          .replace(/\bMMMM\b/, this.month)
          .replace(/\bMMM\b/, this.monthShort)
          .replace(/\bMM\b/, this.monthNumber.toString().padStart(2, '0'))
          .replace(/\bM\b/, this.monthNumber)
      }
    }

    class Month {
      constructor(date = null, lang = 'default') {
        const day = new Day(date, lang);
        const monthsSize = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
        this.lang = lang;

        this.name = day.month;
        this.number = day.monthNumber;
        this.year = day.year;
        this.numberOfDays = monthsSize[this.number - 1];

        if (this.number === 2) {
          this.numberOfDays += isLeapYear(day.year) ? 1 : 0;
        }

        this[Symbol.iterator] = function* () {
          let number = 1;
          yield this.getDay(number);
          while (number < this.numberOfDays) {
            ++number;
            yield this.getDay(number);
          }
        }
      }

      getDay(date) {
        return new Day(new Date(this.year, this.number - 1, date), this.lang);
      }
    }

    class Calendar {
      weekDays = Array.from({ length: 7 });

      constructor(year = null, monthNumber = null, lang = 'default') {
        this.today = new Day(null, lang);
        this.year = year ?? this.today.year;
        this.month = new Month(new Date(this.year, (monthNumber || this.today.monthNumber) - 1), lang);
        this.lang = lang;

        this[Symbol.iterator] = function* () {
          let number = 1;
          yield this.getMonth(number);
          while (number < 12) {
            ++number;
            yield this.getMonth(number);
          }
        }

        this.weekDays.forEach((_, i) => {
          const day = this.month.getDay(i + 1);
          if (!this.weekDays.includes(day.day)) {
            this.weekDays[day.dayNumber - 1] = day.day
          }
        })
      }

      get isLeapYear() {
        return isLeapYear(this.year);
      }

      getMonth(monthNumber) {
        return new Month(new Date(this.year, monthNumber - 1), this.lang);
      }

      getPreviousMonth() {
        if (this.month.number === 1) {
          return new Month(new Date(this.year - 1, 11), this.lang);
        }

        return new Month(new Date(this.year, this.month.number - 2), this.lang);
      }

      getNextMonth() {
        if (this.month.number === 12) {
          return new Month(new Date(this.year + 1, 0), this.lang);
        }

        return new Month(new Date(this.year, this.month.number + 2), this.lang);
      }

      goToDate(monthNumber, year) {
        this.month = new Month(new Date(year, monthNumber - 1), this.lang);
        this.year = year;
      }

      goToNextYear() {
        this.year += 1;
        this.month = new Month(new Date(this.year, 0), this.lang);
      }

      goToPreviousYear() {
        this.year -= 1;
        this.month = new Month(new Date(this.year, 11), this.lang);
      }

      goToNextMonth() {
        if (this.month.number === 12) {
          return this.goToNextYear();
        }

        this.month = new Month(new Date(this.year, (this.month.number + 1) - 1), this.lang);
      }

      goToPreviousMonth() {
        if (this.month.number === 1) {
          return this.goToPreviousYear();
        }

        this.month = new Month(new Date(this.year, (this.month.number - 1) - 1), this.lang);
      }
    }

    class DatePicker extends HTMLElement {
      format = 'MMM DD, YYYY';
      position = 'bottom';
      visible = false;
      date = null;
      mounted = false;
      // elements
      toggleButton = null;
      calendarDropDown = null;
      calendarDateElement = null;
      calendarDaysContainer = null;
      selectedDayElement = null;

      constructor() {
        super();

        const lang = window.navigator.language;
        const date = new Date(this.date ?? (this.getAttribute("date") || Date.now()));

        this.shadow = this.attachShadow({ mode: "open" });
        this.date = new Day(date, lang);
        this.calendar = new Calendar(this.date.year, this.date.monthNumber, lang);

        this.format = this.getAttribute('format') || this.format;
        this.position = DatePicker.position.includes(this.getAttribute('position'))
          ? this.getAttribute('position')
          : this.position;
        this.visible = this.getAttribute('visible') === ''
          || this.getAttribute('visible') === 'true'
          || this.visible;

        this.render();
      }

      connectedCallback() {
        this.mounted = true;

        this.toggleButton = this.shadow.querySelector('.date-toggle');
        this.calendarDropDown = this.shadow.querySelector('.calendar-dropdown');
        const [prevBtn, calendarDateElement, nextButton] = this.calendarDropDown
          .querySelector('.header').children;
        this.calendarDateElement = calendarDateElement;
        this.calendarDaysContainer = this.calendarDropDown.querySelector('.month-days');

        this.toggleButton.addEventListener('click', () => this.toggleCalendar());
        prevBtn.addEventListener('click', () => this.prevMonth());
        nextButton.addEventListener('click', () => this.nextMonth());
        document.addEventListener('click', (e) => this.handleClickOut(e));

        this.renderCalendarDays();
      }

      attributeChangedCallback(name, oldValue, newValue) {
        if (!this.mounted) return;

        switch (name) {
          case "date":
            this.date = new Day(new Date(newValue));
            this.calendar.goToDate(this.date.monthNumber, this.date.year);
            this.renderCalendarDays();
            this.updateToggleText();
            break;
          case "format":
            this.format = newValue;
            this.updateToggleText();
            break;
          case "visible":
            this.visible = ['', 'true', 'false'].includes(newValue)
              ? newValue === '' || newValue === 'true'
              : this.visible;
            this.toggleCalendar(this.visible);
            break;
          case "position":
            this.position = DatePicker.position.includes(newValue)
              ? newValue
              : this.position;
            this.calendarDropDown.className =
              `calendar-dropdown ${this.visible ? 'visible' : ''} ${this.position}`;
            break;
        }
      }

      toggleCalendar(visible = null) {
        if (visible === null) {
          this.calendarDropDown.classList.toggle('visible');
        } else if (visible) {
          this.calendarDropDown.classList.add('visible');
        } else {
          this.calendarDropDown.classList.remove('visible');
        }

        this.visible = this.calendarDropDown.className.includes('visible');

        if (this.visible) {
          this.calendarDateElement.focus();
        } else {
          this.toggleButton.focus();

          if (!this.isCurrentCalendarMonth()) {
            this.calendar.goToDate(this.date.monthNumber, this.date.year);
            this.renderCalendarDays();
          }
        }
      }

      prevMonth() {
        this.calendar.goToPreviousMonth();
        this.renderCalendarDays();
      }

      nextMonth() {
        this.calendar.goToNextMonth();
        this.renderCalendarDays();
      }

      updateHeaderText() {
        this.calendarDateElement.textContent =
          `${this.calendar.month.name}, ${this.calendar.year}`;
        const monthYear = `${this.calendar.month.name}, ${this.calendar.year}`
        this.calendarDateElement
          .setAttribute('aria-label', `current month ${monthYear}`);
      }

      isSelectedDate(date) {
        return date.date === this.date.date &&
          date.monthNumber === this.date.monthNumber &&
          date.year === this.date.year;
      }

      isCurrentCalendarMonth() {
        return this.calendar.month.number === this.date.monthNumber &&
          this.calendar.year === this.date.year;
      }

      selectDay(el, day) {
        if (day.isEqualTo(this.date)) return;

        this.date = day;

        if (day.monthNumber !== this.calendar.month.number) {
          this.prevMonth();
        } else {
          el.classList.add('selected');
          this.selectedDayElement.classList.remove('selected');
          this.selectedDayElement = el;
        }

        this.toggleCalendar();
        this.updateToggleText();
      }

      handleClickOut(e) {
        if (this.visible && (this !== e.target)) {
          this.toggleCalendar(false);
        }
      }

      getWeekDaysElementStrings() {
        return this.calendar.weekDays
          .map(weekDay => `<span>${weekDay.substring(0, 3)}</span>`)
          .join('');
      }

      getMonthDaysGrid() {
        const firstDayOfTheMonth = this.calendar.month.getDay(1);
        const prevMonth = this.calendar.getPreviousMonth();
        const totalLastMonthFinalDays = firstDayOfTheMonth.dayNumber - 1;
        const totalDays = this.calendar.month.numberOfDays + totalLastMonthFinalDays;
        const monthList = Array.from({ length: totalDays });

        for (let i = totalLastMonthFinalDays; i < totalDays; i++) {
          monthList[i] = this.calendar.month.getDay(i + 1 - totalLastMonthFinalDays)
        }

        for (let i = 0; i < totalLastMonthFinalDays; i++) {
          const inverted = totalLastMonthFinalDays - (i + 1);
          monthList[i] = prevMonth.getDay(prevMonth.numberOfDays - inverted);
        }

        return monthList;
      }

      updateToggleText() {
        const date = this.date.format(this.format)
        this.toggleButton.textContent = date;
      }

      updateMonthDays() {
        this.calendarDaysContainer.innerHTML = '';

        this.getMonthDaysGrid().forEach(day => {
          const el = document.createElement('button');
          el.className = 'month-day';
          el.textContent = day.date;
          el.addEventListener('click', (e) => this.selectDay(el, day));
          el.setAttribute('aria-label', day.format(this.format));

          if (day.monthNumber === this.calendar.month.number) {
            el.classList.add('current');
          }

          if (this.isSelectedDate(day)) {
            el.classList.add('selected');
            this.selectedDayElement = el;
          }

          this.calendarDaysContainer.appendChild(el);
        })
      }

      renderCalendarDays() {
        this.updateHeaderText();
        this.updateMonthDays();
        this.calendarDateElement.focus();
      }

      static get observedAttributes() {
        return ['date', 'format', 'visible', 'position'];
      }

      static get position() {
        return ['top', 'left', 'bottom', 'right'];
      }

      get style() {
        return `
        :host {
          position: relative;
          font-family: sans-serif;
        }
        
        .date-toggle {
          padding: 8px 15px;
          border: none;
          -webkit-appearance: none;
          -moz-appearance: none;
          appearance: none;
          background: #eee;
          color: #333;
          border-radius: 6px;
          font-weight: bold;
          cursor: pointer;
          text-transform: capitalize;
        }
        
        .calendar-dropdown {
          display: none;
          width: 300px;
          height: 300px;
          position: absolute;
          top: 100%;
          left: 50%;
          transform: translate(-50%, 8px);
          padding: 20px;
          background: #fff;
          border-radius: 5px;
          box-shadow: 0 0 8px rgba(0,0,0,0.2);
        }
        
        .calendar-dropdown.top {
          top: auto;
          bottom: 100%;
          transform: translate(-50%, -8px);
        }
        
        .calendar-dropdown.left {
          top: 50%;
          left: 0;
          transform: translate(calc(-8px + -100%), -50%);
        }
        
        .calendar-dropdown.right {
          top: 50%;
          left: 100%;
          transform: translate(8px, -50%);
        }
        
        .calendar-dropdown.visible {
          display: block;
        }
        
        .header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin: 10px 0 30px;
        }
        
        .header h4 {
          margin: 0;
          text-transform: capitalize;
          font-size: 21px;
          font-weight: bold;
        }
        
        .header button {
          padding: 0;
          border: 8px solid transparent;
          width: 0;
          height: 0;
          border-radius: 2px;
          border-top-color: #222;
          transform: rotate(90deg);
          cursor: pointer;
          background: none;
          position: relative;
        }
        
        .header button::after {
          content: '';
          display: block;
          width: 25px;
          height: 25px;
          position: absolute;
          left: 50%;
          top: 50%;
          transform: translate(-50%, -50%);
        }
        
        .header button:last-of-type {
          transform: rotate(-90deg);
        }
        
        .week-days {
          display: grid;
          grid-template-columns: repeat(7, 1fr);
          grid-gap: 5px;
          margin-bottom: 10px;
        }
        
        .week-days span {
          display: flex;
          justify-content: center;
          align-items: center;
          font-size: 10px;
          text-transform: capitalize;
        }
        
        .month-days {
          display: grid;
          grid-template-columns: repeat(7, 1fr);
          grid-gap: 5px;
        }
        
        .month-day {
          padding: 8px 5px;
          background: #c7c9d3;
          color: #fff;
          display: flex;
          justify-content: center;
          align-items: center;
          border-radius: 2px;
          cursor: pointer;
          border: none;
        }
        
        .month-day.current {
          background: ##000000;
        }
        
        .month-day.selected {
          background: #0C090A;
          color: #ffffff;
        }
        
        .month-day:hover {
          background: #E5E4E2;
        }
      `;
      }

      render() {
        const monthYear = `${this.calendar.month.name}, ${this.calendar.year}`;
        const date = this.date.format(this.format)
        this.shadow.innerHTML = `
        <style>${this.style}</style>
        <button type="button" class="date-toggle">${date}</button>
        <div class="calendar-dropdown ${this.visible ? 'visible' : ''} ${this.position}">
          <div class="header">
              <button type="button" class="prev-month" aria-label="previous month"></button>
              <h4 tabindex="0" aria-label="current month ${monthYear}">
                ${monthYear}
              </h4>
              <button type="button" class="prev-month" aria-label="next month"></button>
          </div>
          <div class="week-days">${this.getWeekDaysElementStrings()}</div>
          <div class="month-days"></div>
        </div>
      `

      }
    }

    customElements.define("date-picker", DatePicker);
  </script>
</body>

</html>